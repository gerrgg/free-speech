(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{41:function(e,t,n){e.exports=n(71)},68:function(e,t,n){},71:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(18),u=n.n(c),l=n(5),o=n(14),s=n(36),i=n(37),m=n(1),f=n.n(m),p=n(3),d=n(12),v=n(39),E=n(40),b=n(13),g=n.n(b),h=function(e){var t=Object(a.useState)(""),n=Object(E.a)(t,2),r=n[0],c=n[1];return{type:e,value:r,onChange:function(e){c(e.target.value)},onReset:function(){c("")}}},O=function(e){var t=null,n=function(){var t=Object(p.a)(f.a.mark((function t(){var n;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.a.get(e);case 2:return n=t.sent,t.abrupt("return",n.data);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return{create:function(){var n=Object(p.a)(f.a.mark((function n(a){var r,c;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r={headers:{Authorization:t}},n.next=3,g.a.post(e,a,r);case 3:return c=n.sent,n.abrupt("return",c.data);case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),getAll:n,update:function(){var t=Object(p.a)(f.a.mark((function t(n,a){var r;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.a.put("".concat(e,"/").concat(n),a);case 2:return r=t.sent,t.abrupt("return",r.data);case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),setToken:function(e){t="bearer ".concat(e)},remove:function(){var n=Object(p.a)(f.a.mark((function n(a){var r;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r={headers:{Authorization:t}},g.a.delete("".concat(e,"/").concat(a),r);case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}},w=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;return function(){var n=Object(p.a)(f.a.mark((function n(a){return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:a({type:"SET_NOTIFICATION",data:{notification:e}}),clearTimeout(),setTimeout((function(){a({type:"SET_NOTIFICATION",data:{notification:null}})}),t);case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_NOTIFICATION":return t.data.notification;default:return e}},k={create:function(){var e=Object(p.a)(f.a.mark((function e(t,n){var a,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="http://localhost:3003/api/blogs/".concat(t,"/comments"),e.next=3,g.a.post(a,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},I=O("http://localhost:3003/api/blogs"),y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_BLOGS":return t.data;case"NEW_BLOG":return[].concat(Object(v.a)(e),[t.data]);case"DELETE_BLOG":var n=t.data.id;return e.filter((function(e){return e.id!==n}));case"LIKE_BLOG":var a=t.data.id,r=e.find((function(e){return e.id===a})),c=Object(d.a)(Object(d.a)({},r),{},{likes:r.likes+1});return e.map((function(e){return e.id!==a?e:c}));case"UPDATE_BLOG_COMMENTS":var u=t.data.id,l=e.find((function(e){return e.id===u})),o=Object(d.a)(Object(d.a)({},l),{},{comments:l.comments.concat(t.data.newComment)});return e.map((function(e){return e.id!==u?e:o}));default:return e}},N={login:function(){var e=Object(p.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.post("http://localhost:3003/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},x=O("http://localhost:3003/api/blogs"),U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN_USER":return t.data;case"LOGOUT_USER":return null;default:return e}},T=O("http://localhost:3003/api/users"),S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_USERS":return t.data;default:return e}},L=Object(o.combineReducers)({loggedInUser:U,blogs:y,notification:j,users:S}),_=Object(o.createStore)(L,Object(i.composeWithDevTools)(Object(o.applyMiddleware)(s.a))),B=(n(68),n(6)),C=n(4),D=function(e){var t=e.blogs;return t?r.a.createElement("ul",null,t.map((function(e){return r.a.createElement("li",null,r.a.createElement(B.b,{to:"/blog/".concat(e.id)},e.title))}))):null},G=n(38),A=n.n(G),R=function(e){var t=e.comment;return r.a.createElement("div",{className:"comment"},r.a.createElement("small",{className:"posted-on"},function(){var e=t.date.substring(0,10);return A()(e,"YYYY-MM-DD").fromNow()}()),r.a.createElement("p",{className:"content"},t.content))},M=function(){var e=Object(l.b)(),t=Object(C.f)().id,n=h("text");return r.a.createElement("form",{onSubmit:function(a){a.preventDefault();var r={content:n.value};e(function(e,t){return function(){var n=Object(p.a)(f.a.mark((function n(a){var r;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,k.create(e,t);case 3:r=n.sent,a({type:"UPDATE_BLOG_COMMENTS",data:{id:e,newComment:r.id}}),a(w("Comment successful")),n.next=12;break;case 8:n.prev=8,n.t0=n.catch(0),console.log(n.t0),a(w("Update failed: ".concat(n.t0.message)));case 12:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(e){return n.apply(this,arguments)}}()}(t,r)),n.onReset()}},r.a.createElement("p",null,"Comment:",r.a.createElement("input",n),r.a.createElement("button",null,"Comment")))},F=function(e){var t=e.blog;return r.a.createElement("h2",{className:"header"},t.title," - ",t.author?t.author:"No Author")},J=function(e){var t=e.url;return r.a.createElement("p",{className:"url"},"URL: ",r.a.createElement("a",{href:t},t))},Y=function(e){var t=e.blog,n=Object(l.b)(),a=Object(d.a)(Object(d.a)({},t),{},{user:t.user.id});return r.a.createElement("div",{className:"likes"},r.a.createElement("p",null,"Likes: ",t.likes),r.a.createElement("button",{className:"likesButton",onClick:function(){return n((e=t.id,r=a,function(){var t=Object(p.a)(f.a.mark((function t(n){var a;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=Object(d.a)(Object(d.a)({},r),{},{likes:r.likes+1}),console.log(e,a),t.next=5,I.update(e,a);case 5:n({type:"LIKE_BLOG",data:{id:e}}),n(w("Update successful")),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),console.log(t.t0),n(w("Update failed: ".concat(t.t0.message)));case 13:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()));var e,r}},"Like"))},P=function(e){var t=e.user;return r.a.createElement("p",{className:"user"},"User: ",t?r.a.createElement(B.b,{to:"/user/".concat(t.id)},t.username):null)},W=function(e){var t=e.blogID,n=e.user,a=e.loggedInUser,c=Object(l.b)();return r.a.createElement("div",{className:"deleteButton"},n.id===a.id?r.a.createElement("button",{className:"delete",onClick:function(){return c((e=t,n=a.token,function(){var t=Object(p.a)(f.a.mark((function t(a){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,I.remove(e,n);case 3:a({type:"DELETE_BLOG",data:{id:e}}),a(w("Delete successful")),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0),a(w("Delete failed: ".concat(t.t0.message)));case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()));var e,n}},"Delete"):null)},z=function(e){var t=e.comments;return 0===t.length?null:r.a.createElement("div",{className:"comments"},r.a.createElement("h4",null,"Comments"),t.map((function(e){return r.a.createElement(R,{key:e.id,comment:e})})))},K=function(e){var t=e.blogs,n=e.loggedInUser,a=Object(C.f)().id,c=t.find((function(e){return e.id===a}));return c?r.a.createElement("div",{className:"blog"},r.a.createElement(F,{blog:c}),r.a.createElement(J,{url:c.url}),r.a.createElement(Y,{blog:c}),r.a.createElement(P,{user:c.user}),r.a.createElement(W,{blogID:c.id,user:c.user,loggedInUser:n}),r.a.createElement(M,null),r.a.createElement(z,{comments:c.comments})):null},q=function(){var e=Object(l.b)(),t=h("text"),n=h("password");return r.a.createElement("form",{id:"loginForm",onSubmit:function(a){a.preventDefault(),e(function(e,t){return function(){var n=Object(p.a)(f.a.mark((function n(a){var r;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,N.login({username:e,password:t});case 3:r=n.sent,window.localStorage.setItem("loggedInUser",JSON.stringify(r)),x.setToken(r.token),a({type:"LOGIN_USER",data:r}),a(w("Login successful")),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(0),a(w("Invalid password / username combo"));case 13:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(e){return n.apply(this,arguments)}}()}(t.value,n.value))}},r.a.createElement("h1",null,"Login"),r.a.createElement("p",null,"Username",r.a.createElement("input",t)),r.a.createElement("p",null,"Password",r.a.createElement("input",n)),r.a.createElement("button",{id:"loginButton",type:"submit"},"login"))},H=function(){var e=Object(l.c)((function(e){return e.notification}));if(!e)return null;return r.a.createElement("div",{style:{border:"solid",padding:10,borderWidth:1}},e)},Q=function(){var e=Object(l.b)(),t=Object(l.c)((function(e){return e.loggedInUser}));return r.a.createElement("div",{id:"logoutButton"},r.a.createElement("strong",null,t.name," is logged in"),r.a.createElement("br",null),r.a.createElement("button",{onClick:function(){return e(function(){var e=Object(p.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.localStorage.removeItem("loggedInUser"),t({type:"LOGOUT_USER"});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},"Logout"))},V=function(){var e=function(){return r.a.createElement("a",{href:"/",id:"logo"},"Free Speech",r.a.createElement("span",{role:"img","aria-label":"parrot"},"\ud83e\udd10"))},t=Object(l.c)((function(e){return e.loggedInUser}));return r.a.createElement("nav",{id:"header"},r.a.createElement(e,null),r.a.createElement(B.b,{to:"/"},"home"),r.a.createElement(B.b,{to:"/users"},"Users"),r.a.createElement("div",{className:"header-right"},t?r.a.createElement(Q,null):null))},X=function(e){var t=e.user;return r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement(B.b,{to:"/user/".concat(t.id)},t.name)),r.a.createElement("td",null,t.blogs.length))},Z=function(e){var t=e.users;return r.a.createElement("div",{id:"users"},r.a.createElement("h2",null,"Users"),r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"User"),r.a.createElement("th",null,"Blogs created"))),r.a.createElement("tbody",null,t.map((function(e){return r.a.createElement(X,{key:e.id,user:e})})))))},$=function(e){var t=e.users,n=Object(C.f)().id,a=t.find((function(e){return n===e.id}));return a?r.a.createElement("div",{id:"user"},r.a.createElement("h2",{className:"title"},a.username," ",r.a.createElement("span",{className:"name"},"<",a.name,">")),r.a.createElement("h5",null,"Blogs"),r.a.createElement("ul",{className:"blogs"},r.a.createElement(D,{blogs:a.blogs}))):null};var ee=function(){var e=Object(l.b)();Object(a.useEffect)((function(){e(function(){var e=Object(p.a)(f.a.mark((function e(t){var n,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=window.localStorage.getItem("loggedInUser"))&&(a=JSON.parse(n),x.setToken(a.token),t({type:"LOGIN_USER",data:a}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e(function(){var e=Object(p.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.getAll();case 2:n=e.sent,t({type:"INIT_BLOGS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e(function(){var e=Object(p.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.getAll();case 2:n=e.sent,t({type:"INIT_USERS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[e]);var t=Object(l.c)((function(e){return e}));return r.a.createElement(B.a,null,r.a.createElement("div",null,r.a.createElement(V,null),r.a.createElement(H,null),r.a.createElement(C.c,null,r.a.createElement(C.a,{path:"/users"},r.a.createElement(Z,{users:t.users})),r.a.createElement(C.a,{path:"/user/:id"},r.a.createElement($,{users:t.users})),r.a.createElement(C.a,{path:"/blog/:id"},r.a.createElement(K,{blogs:t.blogs,loggedInUser:t.loggedInUser})),r.a.createElement(C.a,{path:"/",render:function(){return t.loggedInUser?r.a.createElement(D,{blogs:t.blogs}):r.a.createElement(q,null)}}))))};u.a.render(r.a.createElement(l.a,{store:_},r.a.createElement(ee,null)),document.getElementById("root"))}},[[41,1,2]]]);
//# sourceMappingURL=main.ad0c9b47.chunk.js.map